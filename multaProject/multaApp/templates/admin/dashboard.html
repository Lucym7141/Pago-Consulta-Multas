{% extends "base.html" %}
{% block content %}

<style>
/* Contenedor principal centrado con m√°rgenes laterales */
.dashboard-wrapper {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem 1rem;
}

.summary-card {
    text-align: center;
    padding: 1.5rem;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
    height: 100%;
}

.summary-card:hover {
    transform: translateY(-5px);
}

.summary-card .icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.summary-card .value {
    font-size: 1.8rem;
    font-weight: 700;
    color: #0d6efd;
}

.summary-card .label {
    font-size: 0.9rem;
    color: #666;
}

.banner-mensaje {
    background: linear-gradient(135deg, #e9f1ff 0%, #ffffff 100%);
    border-left: 5px solid #0d6efd;
    padding: 1.5rem;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 18px;
}

.banner-icono {
    font-size: 2rem;
    color: #0d6efd;
    flex-shrink: 0;
}

.banner-texto .titulo {
    font-weight: 700;
    color: #0d6efd;
    font-size: 1.1rem;
}

.banner-texto .sub {
    color: #666;
    font-size: 0.95rem;
}

.filter-buttons {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.filter-buttons .btn {
    border: 2px solid #0d6efd;
    color: #0d6efd;
    background: white;
    border-radius: 8px;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
}

.filter-buttons .btn.active {
    background: #0d6efd;
    color: white;
}

.filter-buttons .btn:hover {
    background: #0d6efd;
    color: white;
}

.search-form {
    display: flex;
    gap: 0.5rem;
    align-items: start;
    flex-wrap: wrap;
}

.search-input-wrapper {
    flex: 1;
    min-width: 250px;
}

.btn-search {
    white-space: nowrap;
}

/* Responsive */
@media (max-width: 768px) {
    .dashboard-wrapper {
        padding: 1rem 0.5rem;
    }
    
    .summary-card {
        padding: 1rem;
    }
    
    .summary-card .icon {
        font-size: 1.5rem;
    }
    
    .summary-card .value {
        font-size: 1.5rem;
    }
    
    .summary-card .label {
        font-size: 0.8rem;
    }
    
    .banner-mensaje {
        flex-direction: column;
        text-align: center;
        padding: 1rem;
    }
    
    .banner-icono {
        font-size: 1.5rem;
    }
    
    .banner-texto .titulo {
        font-size: 1rem;
    }
    
    .banner-texto .sub {
        font-size: 0.85rem;
    }
    
    .filter-buttons {
        width: 100%;
        justify-content: center;
    }
    
    .filter-buttons .btn {
        flex: 1;
        min-width: 80px;
        font-size: 0.85rem;
        padding: 0.4rem 0.5rem;
    }
    
    .btn-search {
        width: 100%;
    }
    
    .search-input-wrapper {
        width: 100%;
    }
}

@media (max-width: 576px) {
    .summary-card {
        padding: 0.8rem;
    }
    
    .summary-card .value {
        font-size: 1.3rem;
    }
    
    .filter-buttons .btn {
        font-size: 0.8rem;
        padding: 0.35rem 0.4rem;
    }
}

@media (min-width: 2000px) {
    .dashboard-wrapper {
        max-width: 2000px;
    }
}
</style>

<div class="dashboard-wrapper">
    <!-- Tarjetas de resumen -->
    <div class="row g-3 g-md-4 mb-3 mb-md-4">
        <div class="col-6 col-md-3">
            <div class="card summary-card">
                <div class="icon">üìÑ</div>
                <div class="value">{{ resumen.total }}</div>
                <div class="label">Total de Multas</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card summary-card">
                <div class="icon">‚ö†Ô∏è</div>
                <div class="value">{{ resumen.pendientes }}</div>
                <div class="label">Pendientes</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card summary-card">
                <div class="icon">‚úÖ</div>
                <div class="value">{{ resumen.pagadas }}</div>
                <div class="label">Pagadas</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card summary-card">
                <div class="icon">üí∞</div>
                <div class="value">${{ resumen.recaudado }}</div>
                <div class="label">Recaudado</div>
            </div>
        </div>
    </div>

    <!-- Banner -->
    <div class="banner-mensaje">
        <div class="banner-icono">‚úî</div>
        <div class="banner-texto">
            <span class="titulo">Mant√©n tus pagos al d√≠a</span><br>
            <span class="sub">y evita intereses. Cada acci√≥n cuenta para conducir con tranquilidad.</span>
        </div>
    </div>

    <!-- Formulario de b√∫squeda -->
    <div class="card p-3 mb-3">
        <form method="get" class="search-form">
            <div class="search-input-wrapper">
                <input 
                    type="text" 
                    name="busqueda" 
                    value="{{ busqueda }}" 
                    class="form-control" 
                    placeholder="üîç Buscar por placa o fecha"
                    id="campoBusqueda"
                >
                <small class="text-muted d-block mt-1">
                    Ej: ABC-123 o 2024-11-10, 10-11-2024, 10/11/2024
                </small>
            </div>
            
            <input type="hidden" name="filtro" value="{{ filtro }}" id="filtroActual">
            
            <div class="filter-buttons">
                <button type="button" onclick="setFiltro('todas')" class="btn {% if filtro == 'todas' %}active{% endif %}">Todas</button>
                <button type="button" onclick="setFiltro('pendientes')" class="btn {% if filtro == 'pendientes' %}active{% endif %}">Pendientes</button>
                <button type="button" onclick="setFiltro('pagadas')" class="btn {% if filtro == 'pagadas' %}active{% endif %}">Pagadas</button>
            </div>
            
            <button type="submit" class="btn btn-primary btn-search">Buscar</button>
            
            {% if busqueda or filtro != 'todas' %}
            <a href="{% url 'dashboard' %}" class="btn btn-secondary" title="Limpiar filtros">‚úñ</a>
            {% endif %}
        </form>
        
        {% if busqueda %}
        <div class="alert alert-info mt-3 mb-0 py-2">
            <strong>Buscando:</strong> "{{ busqueda }}" 
            {% if filtro != 'todas' %}| <strong>Estado:</strong> {{ filtro|title }}{% endif %}
            | <strong>Resultados:</strong> {{ multas.count }}
        </div>
        {% endif %}
    </div>

    <!-- Tabla de multas -->
    {% include "admin/tabla_multas.html" %}
</div>

<script>
function setFiltro(valor) {
    document.getElementById('filtroActual').value = valor;
    document.querySelectorAll('.filter-buttons button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    event.target.closest('form').submit();
}
</script>

{% endblock %}